# Блок-схема алгоритма работы системы распознавания эмоций

## 1. Обучение модели

```mermaid
graph TD
    A[Начало] --> B[Загрузка датасета]
    B --> C[Создание train/test разделения]
    C --> D[Аугментация данных]
    D --> E[Загрузка ResNet18]
    E --> F[Модификация последнего слоя]
    F --> G[Настройка оптимизатора]
    G --> H[Обучение модели]
    H --> I{Последняя эпоха?}
    I -->|Нет| H
    I -->|Да| J[Сохранение модели]
    J --> K[Вычисление метрик]
    K --> L[Сохранение метрик]
    L --> M[Конец]
    
    D --> D1[RandomResizedCrop]
    D --> D2[RandomHorizontalFlip]
    D --> D3[Нормализация]
    
    K --> K1[Accuracy]
    K --> K2[F1 Score]
    K --> K3[Confusion Matrix]
    K --> K4[ROC Curve]
```

## 2. Инференс (Камера)

```mermaid
graph TD
    A[Начало] --> B[Загрузка модели]
    B --> C[Инициализация камеры]
    C --> D[Захват кадра]
    D --> E[Детекция лиц]
    E --> F{Лица найдены?}
    F -->|Нет| D
    F -->|Да| G[Извлечение ROI]
    G --> H[Предобработка]
    H --> I[Предсказание модели]
    I --> J[Получение вероятностей]
    J --> K[Определение эмоции]
    K --> L[Наложение результата]
    L --> M[Отображение]
    M --> N{Клавиша 'q' нажата?}
    N -->|Нет| D
    N -->|Да| O[Освобождение ресурсов]
    O --> P[Конец]
    
    E --> E1[Haar Cascade]
    H --> H1[Resize]
    H --> H2[Normalize]
    J --> J1[Softmax]
```

## 3. Инференс (Загрузка изображения)

```mermaid
graph TD
    A[Начало] --> B[Загрузка модели]
    B --> C[Выбор изображения]
    C --> D[Детекция лиц]
    D --> E{Лица найдены?}
    E -->|Нет| F[Обработка всего изображения]
    E -->|Да| G[Обработка ROI лиц]
    F --> H[Предобработка]
    G --> H
    H --> I[Предсказание модели]
    I --> J[Получение вероятностей]
    J --> K[Отображение результатов]
    K --> L[Конец]
```

## Описание этапов

### Обучение:
1. **Подготовка данных**: Разделение на train/test, аугментация
2. **Настройка модели**: ResNet18 с заменой последнего слоя
3. **Обучение**: Forward/backward pass, оптимизация
4. **Оценка**: Вычисление метрик качества

### Инференс:
1. **Детекция**: Поиск лиц на кадре
2. **Предобработка**: Изменение размера, нормализация
3. **Предсказание**: Прогон через нейросеть
4. **Визуализация**: Наложение результатов на изображение
